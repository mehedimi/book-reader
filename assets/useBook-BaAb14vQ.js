import{b as R,c as N,l as et,u as ot}from"./useHttp-Cd46308I.js";import{d as nt,c as w,f as _,F as B,r as G,k as X,b as st,o as x,n as z,u as M,t as Y,l as $,a as rt,w as lt,m as at,p as it,q as ct,s as ut,v as ft,g as C,x as J,y as K,h as I}from"./index-CGetryrB.js";const dt={class:"flex flex-col my-8 gap-5"},mt={class:"w-1/4"},pt=["src","alt"],ht={class:"flex-1"},vt={class:"mt-3 font-bold text-gray-600"},gt={class:"my-1.5 text-sm text-gray-500"},_t={key:0},bt={key:0,class:"flex justify-center my-10"},yt={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-14 h-14 block text-gray-500 animate-spin"},wt=_("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"},null,-1),xt=[wt],kt={key:1,class:"text-center"},Tt=_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-14 h-14 mx-auto text-gray-400"},[_("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"})],-1),St=_("p",{class:"my-2 text-gray-400"},"Empty Books",-1),Et=[Tt,St],Rt=nt({__name:"Books",props:{books:{},isLoading:{type:Boolean}},setup(t){return(n,e)=>{const s=st("router-link");return x(),w(B,null,[_("div",dt,[(x(!0),w(B,null,G(n.books,o=>(x(),w("div",{class:z(["p-5 rounded-3xl flex gap-x-5 bg-gradient-to-br",M(R)[o.id%M(R).length]]),key:o.id},[_("div",mt,[_("img",{src:o.thumbnail,class:"rounded-2xl",alt:o.title},null,8,pt)]),_("div",ht,[_("h2",vt,Y(o.title),1),_("p",gt,[$(" By "),(x(!0),w(B,null,G(o.authors,(r,c)=>(x(),w(B,null,[rt(s,{to:{name:"author.book",params:{id:r.id}},class:z(M(N)[o.id%M(N).length])},{default:lt(()=>[$(Y(r.name),1)]),_:2},1032,["to","class"]),o.authors.length-1!==c?(x(),w("span",_t,", ")):X("",!0)],64))),256))])])],2))),128))]),n.isLoading||!n.books.length?(x(),w("div",bt,[n.isLoading?(x(),w("svg",yt,xt)):(x(),w("div",kt,Et))])):X("",!0)],64)}}});function Ct(t){return ct()?(ut(t),!0):!1}function v(t){return typeof t=="function"?t():M(t)}const Lt=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Dt=Object.prototype.toString,At=t=>Dt.call(t)==="[object Object]",L=()=>{};function Z(t,n){function e(...s){return new Promise((o,r)=>{Promise.resolve(t(()=>n.apply(this,s),{fn:n,thisArg:this,args:s})).then(o).catch(r)})}return e}function Mt(t,n={}){let e,s,o=L;const r=u=>{clearTimeout(u),o(),o=L};return u=>{const d=v(t),i=v(n.maxWait);return e&&r(e),d<=0||i!==void 0&&i<=0?(s&&(r(s),s=null),Promise.resolve(u())):new Promise((l,f)=>{o=n.rejectOnCancel?f:l,i&&!s&&(s=setTimeout(()=>{e&&r(e),s=null,l(u())},i)),e=setTimeout(()=>{s&&r(s),s=null,l(u())},d)})}}function Bt(t,n=!0,e=!0,s=!1){let o=0,r,c=!0,u=L,d;const i=()=>{r&&(clearTimeout(r),r=void 0,u(),u=L)};return f=>{const m=v(t),g=Date.now()-o,k=()=>d=f();return i(),m<=0?(o=Date.now(),k()):(g>m&&(e||!c)?(o=Date.now(),k()):n&&(d=new Promise((T,h)=>{u=s?h:T,r=setTimeout(()=>{o=Date.now(),c=!0,T(k()),i()},Math.max(0,m-g))})),!e&&!r&&(r=setTimeout(()=>c=!0,m)),c=!1,d)}}function jt(t){return t||ft()}function It(t,n=200,e={}){return Z(Mt(n,e),t)}function Ot(t,n=200,e=!1,s=!0,o=!1){return Z(Bt(n,e,s,o),t)}function Wt(t,n=!0,e){jt()?at(t,e):n?t():it(t)}function Ft(t){var n;const e=v(t);return(n=e==null?void 0:e.$el)!=null?n:e}const q=Lt?window:void 0;function Q(...t){let n,e,s,o;if(typeof t[0]=="string"||Array.isArray(t[0])?([e,s,o]=t,n=q):[n,e,s,o]=t,!n)return L;Array.isArray(e)||(e=[e]),Array.isArray(s)||(s=[s]);const r=[],c=()=>{r.forEach(l=>l()),r.length=0},u=(l,f,m,g)=>(l.addEventListener(f,m,g),()=>l.removeEventListener(f,m,g)),d=I(()=>[Ft(n),v(o)],([l,f])=>{if(c(),!l)return;const m=At(f)?{...f}:f;r.push(...e.flatMap(g=>s.map(k=>u(l,g,k,m))))},{immediate:!0,flush:"post"}),i=()=>{d(),c()};return Ct(i),i}const U=1;function Vt(t,n={}){const{throttle:e=0,idle:s=200,onStop:o=L,onScroll:r=L,offset:c={left:0,right:0,top:0,bottom:0},eventListenerOptions:u={capture:!1,passive:!0},behavior:d="auto",window:i=q}=n,l=C(0),f=C(0),m=J({get(){return l.value},set(a){k(a,void 0)}}),g=J({get(){return f.value},set(a){k(void 0,a)}});function k(a,S){var p,D,A;if(!i)return;const y=v(t);y&&((A=y instanceof Document?i.document.body:y)==null||A.scrollTo({top:(p=v(S))!=null?p:g.value,left:(D=v(a))!=null?D:m.value,behavior:v(d)}))}const T=C(!1),h=K({left:!0,right:!1,top:!0,bottom:!1}),b=K({left:!1,right:!1,top:!1,bottom:!1}),O=a=>{T.value&&(T.value=!1,b.left=!1,b.right=!1,b.top=!1,b.bottom=!1,o(a))},tt=It(O,e+s),j=a=>{var S;if(!i)return;const p=a.document?a.document.documentElement:(S=a.documentElement)!=null?S:a,{display:D,flexDirection:A}=getComputedStyle(p),y=p.scrollLeft;b.left=y<l.value,b.right=y>l.value;const F=Math.abs(y)<=0+(c.left||0),V=Math.abs(y)+p.clientWidth>=p.scrollWidth-(c.right||0)-U;D==="flex"&&A==="row-reverse"?(h.left=V,h.right=F):(h.left=F,h.right=V),l.value=y;let E=p.scrollTop;a===i.document&&!E&&(E=i.document.body.scrollTop),b.top=E<f.value,b.bottom=E>f.value;const H=Math.abs(E)<=0+(c.top||0),P=Math.abs(E)+p.clientHeight>=p.scrollHeight-(c.bottom||0)-U;D==="flex"&&A==="column-reverse"?(h.top=P,h.bottom=H):(h.top=H,h.bottom=P),f.value=E},W=a=>{var S;if(!i)return;const p=(S=a.target.documentElement)!=null?S:a.target;j(p),T.value=!0,tt(a),r(a)};return Q(t,"scroll",e?Ot(W,e,!0,!1):W,u),Wt(()=>{const a=v(t);a&&j(a)}),Q(t,"scrollend",O,u),{x:m,y:g,isScrolling:T,arrivedState:h,directions:b,measure(){const a=v(t);i&&a&&j(a)}}}function Nt(t){const n=C(!1),e=C([]),s=C(t==null?void 0:t.termId);let o=null;const r=C(""),c=ot();function u(l){s.value=l}async function d(){if(!(o===-1||n.value))return n.value=!0,c.get("/books",{params:{lastId:o,s:r.value,limit:16,termId:s.value}}).then(({data:{data:l}})=>{e.value=e.value.concat(l),l.length?o=l[l.length-1].id:o=-1}).finally(()=>{n.value=!1})}const{arrivedState:i}=Vt(document,{throttle:100,behavior:"smooth",offset:{bottom:100}});return d(),I(i,l=>{l.bottom&&d()}),I([r,s],et.debounce(()=>{o=null,e.value=[],d()},500)),{lastId:o,isLoading:n,books:e,s:r,setTermId:u}}export{Rt as _,Nt as u};
