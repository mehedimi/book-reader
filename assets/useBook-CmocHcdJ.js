import{b as R,c as N,l as et,u as ot}from"./useHttp-ekpS3i8x.js";import{d as nt,c as y,f as _,F as B,r as G,k as X,b as st,o as x,n as z,u as M,t as Y,l as $,a as rt,w as lt,m as at,p as it,q as ct,s as ut,v as ft,g as L,x as J,y as K,h as j}from"./index-CUH1tz9p.js";const dt={class:"flex flex-col my-8 gap-5"},mt={class:"w-1/4"},pt=["src","alt"],ht={class:"flex-1"},vt={class:"mt-3 font-bold text-gray-600"},gt={class:"my-1.5 text-sm text-gray-500"},_t={key:0},bt={key:0,class:"flex justify-center my-10"},wt={key:0,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-14 h-14 block text-gray-500 animate-spin"},yt=_("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"},null,-1),xt=[yt],kt={key:1,class:"text-center"},Tt=_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-14 h-14 mx-auto text-gray-400"},[_("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"})],-1),St=_("p",{class:"my-2 text-gray-400"},"Empty Books",-1),Et=[Tt,St],Rt=nt({__name:"Books",props:{books:{},isLoading:{type:Boolean}},setup(t){return(n,e)=>{const s=st("router-link");return x(),y(B,null,[_("div",dt,[(x(!0),y(B,null,G(n.books,o=>(x(),y("div",{class:z(["p-5 rounded-3xl flex gap-x-5 bg-gradient-to-br",M(R)[o.id%M(R).length]]),key:o.id},[_("div",mt,[_("img",{src:o.thumbnail,class:"rounded-2xl",alt:o.title},null,8,pt)]),_("div",ht,[_("h2",vt,Y(o.title),1),_("p",gt,[$(" By "),(x(!0),y(B,null,G(o.authors,(r,c)=>(x(),y(B,null,[rt(s,{to:{name:"author.book",params:{id:r.id}},class:z(M(N)[o.id%M(N).length])},{default:lt(()=>[$(Y(r.name),1)]),_:2},1032,["to","class"]),o.authors.length-1!==c?(x(),y("span",_t,", ")):X("",!0)],64))),256))])])],2))),128))]),n.isLoading||!n.books.length?(x(),y("div",bt,[n.isLoading?(x(),y("svg",wt,xt)):(x(),y("div",kt,Et))])):X("",!0)],64)}}});function Lt(t){return ct()?(ut(t),!0):!1}function v(t){return typeof t=="function"?t():M(t)}const Ct=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Dt=Object.prototype.toString,At=t=>Dt.call(t)==="[object Object]",C=()=>{};function Z(t,n){function e(...s){return new Promise((o,r)=>{Promise.resolve(t(()=>n.apply(this,s),{fn:n,thisArg:this,args:s})).then(o).catch(r)})}return e}function Mt(t,n={}){let e,s,o=C;const r=u=>{clearTimeout(u),o(),o=C};return u=>{const f=v(t),l=v(n.maxWait);return e&&r(e),f<=0||l!==void 0&&l<=0?(s&&(r(s),s=null),Promise.resolve(u())):new Promise((i,d)=>{o=n.rejectOnCancel?d:i,l&&!s&&(s=setTimeout(()=>{e&&r(e),s=null,i(u())},l)),e=setTimeout(()=>{s&&r(s),s=null,i(u())},f)})}}function Bt(t,n=!0,e=!0,s=!1){let o=0,r,c=!0,u=C,f;const l=()=>{r&&(clearTimeout(r),r=void 0,u(),u=C)};return d=>{const m=v(t),g=Date.now()-o,k=()=>f=d();return l(),m<=0?(o=Date.now(),k()):(g>m&&(e||!c)?(o=Date.now(),k()):n&&(f=new Promise((T,h)=>{u=s?h:T,r=setTimeout(()=>{o=Date.now(),c=!0,T(k()),l()},Math.max(0,m-g))})),!e&&!r&&(r=setTimeout(()=>c=!0,m)),c=!1,f)}}function jt(t){return t||ft()}function Ot(t,n=200,e={}){return Z(Mt(n,e),t)}function Wt(t,n=200,e=!1,s=!0,o=!1){return Z(Bt(n,e,s,o),t)}function Ft(t,n=!0,e){jt()?at(t,e):n?t():it(t)}function It(t){var n;const e=v(t);return(n=e==null?void 0:e.$el)!=null?n:e}const q=Ct?window:void 0;function Q(...t){let n,e,s,o;if(typeof t[0]=="string"||Array.isArray(t[0])?([e,s,o]=t,n=q):[n,e,s,o]=t,!n)return C;Array.isArray(e)||(e=[e]),Array.isArray(s)||(s=[s]);const r=[],c=()=>{r.forEach(i=>i()),r.length=0},u=(i,d,m,g)=>(i.addEventListener(d,m,g),()=>i.removeEventListener(d,m,g)),f=j(()=>[It(n),v(o)],([i,d])=>{if(c(),!i)return;const m=At(d)?{...d}:d;r.push(...e.flatMap(g=>s.map(k=>u(i,g,k,m))))},{immediate:!0,flush:"post"}),l=()=>{f(),c()};return Lt(l),l}const U=1;function Vt(t,n={}){const{throttle:e=0,idle:s=200,onStop:o=C,onScroll:r=C,offset:c={left:0,right:0,top:0,bottom:0},eventListenerOptions:u={capture:!1,passive:!0},behavior:f="auto",window:l=q}=n,i=L(0),d=L(0),m=J({get(){return i.value},set(a){k(a,void 0)}}),g=J({get(){return d.value},set(a){k(void 0,a)}});function k(a,S){var p,D,A;if(!l)return;const w=v(t);w&&((A=w instanceof Document?l.document.body:w)==null||A.scrollTo({top:(p=v(S))!=null?p:g.value,left:(D=v(a))!=null?D:m.value,behavior:v(f)}))}const T=L(!1),h=K({left:!0,right:!1,top:!0,bottom:!1}),b=K({left:!1,right:!1,top:!1,bottom:!1}),W=a=>{T.value&&(T.value=!1,b.left=!1,b.right=!1,b.top=!1,b.bottom=!1,o(a))},tt=Ot(W,e+s),O=a=>{var S;if(!l)return;const p=a.document?a.document.documentElement:(S=a.documentElement)!=null?S:a,{display:D,flexDirection:A}=getComputedStyle(p),w=p.scrollLeft;b.left=w<i.value,b.right=w>i.value;const I=Math.abs(w)<=0+(c.left||0),V=Math.abs(w)+p.clientWidth>=p.scrollWidth-(c.right||0)-U;D==="flex"&&A==="row-reverse"?(h.left=V,h.right=I):(h.left=I,h.right=V),i.value=w;let E=p.scrollTop;a===l.document&&!E&&(E=l.document.body.scrollTop),b.top=E<d.value,b.bottom=E>d.value;const H=Math.abs(E)<=0+(c.top||0),P=Math.abs(E)+p.clientHeight>=p.scrollHeight-(c.bottom||0)-U;D==="flex"&&A==="column-reverse"?(h.top=P,h.bottom=H):(h.top=H,h.bottom=P),d.value=E},F=a=>{var S;if(!l)return;const p=(S=a.target.documentElement)!=null?S:a.target;O(p),T.value=!0,tt(a),r(a)};return Q(t,"scroll",e?Wt(F,e,!0,!1):F,u),Ft(()=>{const a=v(t);a&&O(a)}),Q(t,"scrollend",W,u),{x:m,y:g,isScrolling:T,arrivedState:h,directions:b,measure(){const a=v(t);l&&a&&O(a)}}}function Nt(t){const n=L(!1),e=L([]),s=L(t==null?void 0:t.termId);let o=1;const r=L(""),c=ot();function u(l){s.value=l}async function f(){if(!(o===-1||n.value))return n.value=!0,c.get("/books",{params:{page:o,s:r.value,termId:s.value}}).then(({data:{data:l}})=>{e.value=e.value.concat(l),l.length?o++:o=-1}).finally(()=>{n.value=!1})}if(f(),(t==null?void 0:t.infinityLoad)===!0){const{arrivedState:l}=Vt(document,{throttle:100,behavior:"smooth",offset:{bottom:100}});j(l,i=>{i.bottom&&f()})}return j(r,et.debounce(()=>{o=1,e.value=[],f()},500)),j(s,()=>{o=1,e.value=[],f()}),{page:o,isLoading:n,books:e,s:r,setTermId:u}}export{Rt as _,Nt as u};
