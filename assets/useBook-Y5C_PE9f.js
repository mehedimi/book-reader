import{b as R,c as N,L as tt,l as et,u as ot}from"./useHttp-DiYglLJ5.js";import{d as nt,c as T,e as _,F as j,f as G,g as st,h as X,j as rt,o as w,n as z,u as B,t as Y,a as lt,k as at,l as it,m as ct,p as ut,q as ft,s as dt,v as mt,r as L,x as $,y as J,w as M}from"./index-CDmmWMeF.js";const pt={class:"flex flex-col my-8 gap-5"},ht={class:"w-1/4"},vt=["src","alt"],gt={class:"flex-1"},_t={class:"mt-3 font-bold text-gray-600"},bt={class:"my-1.5 text-sm text-gray-500"},yt=_("span",{class:"font-fira"},"By ",-1),wt={key:0},xt={key:0,class:"flex justify-center my-10"},Tt={key:1,class:"text-center"},St=_("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-14 h-14 mx-auto text-gray-400"},[_("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6.042A8.967 8.967 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0 0 18 18a8.967 8.967 0 0 0-6 2.292m0-14.25v14.25"})],-1),kt=_("p",{class:"my-2 text-gray-400"},"Empty Books",-1),Et=[St,kt],Rt=nt({__name:"Books",props:{books:{},isLoading:{type:Boolean}},setup(t){return(n,e)=>{const s=rt("router-link");return w(),T(j,null,[_("div",pt,[(w(!0),T(j,null,G(n.books,o=>(w(),T("div",{class:z(["p-5 rounded-3xl flex gap-x-5 bg-gradient-to-br font-tiro",B(R)[o.id%B(R).length]]),key:o.id},[_("div",ht,[_("img",{src:o.thumbnail,class:"rounded-2xl",alt:o.title},null,8,vt)]),_("div",gt,[_("h2",_t,Y(o.title),1),_("p",bt,[yt,(w(!0),T(j,null,G(o.authors,(r,c)=>(w(),T(j,null,[lt(s,{to:{name:"author.book",params:{id:r.id}},class:z(B(N)[o.id%B(N).length])},{default:at(()=>[it(Y(r.name),1)]),_:2},1032,["to","class"]),o.authors.length-1!==c?(w(),T("span",wt,", ")):X("",!0)],64))),256))])])],2))),128))]),n.isLoading||!n.books.length?(w(),T("div",xt,[n.isLoading?(w(),st(tt,{key:0})):(w(),T("div",Tt,Et))])):X("",!0)],64)}}});function Lt(t){return ft()?(dt(t),!0):!1}function v(t){return typeof t=="function"?t():B(t)}const Ct=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Dt=Object.prototype.toString,At=t=>Dt.call(t)==="[object Object]",C=()=>{};function U(t,n){function e(...s){return new Promise((o,r)=>{Promise.resolve(t(()=>n.apply(this,s),{fn:n,thisArg:this,args:s})).then(o).catch(r)})}return e}function Bt(t,n={}){let e,s,o=C;const r=u=>{clearTimeout(u),o(),o=C};return u=>{const f=v(t),l=v(n.maxWait);return e&&r(e),f<=0||l!==void 0&&l<=0?(s&&(r(s),s=null),Promise.resolve(u())):new Promise((i,d)=>{o=n.rejectOnCancel?d:i,l&&!s&&(s=setTimeout(()=>{e&&r(e),s=null,i(u())},l)),e=setTimeout(()=>{s&&r(s),s=null,i(u())},f)})}}function jt(t,n=!0,e=!0,s=!1){let o=0,r,c=!0,u=C,f;const l=()=>{r&&(clearTimeout(r),r=void 0,u(),u=C)};return d=>{const m=v(t),g=Date.now()-o,x=()=>f=d();return l(),m<=0?(o=Date.now(),x()):(g>m&&(e||!c)?(o=Date.now(),x()):n&&(f=new Promise((S,h)=>{u=s?h:S,r=setTimeout(()=>{o=Date.now(),c=!0,S(x()),l()},Math.max(0,m-g))})),!e&&!r&&(r=setTimeout(()=>c=!0,m)),c=!1,f)}}function Mt(t){return t||mt()}function Ot(t,n=200,e={}){return U(Bt(n,e),t)}function Wt(t,n=200,e=!1,s=!0,o=!1){return U(jt(n,e,s,o),t)}function Ft(t,n=!0,e){Mt()?ct(t,e):n?t():ut(t)}function It(t){var n;const e=v(t);return(n=e==null?void 0:e.$el)!=null?n:e}const Z=Ct?window:void 0;function K(...t){let n,e,s,o;if(typeof t[0]=="string"||Array.isArray(t[0])?([e,s,o]=t,n=Z):[n,e,s,o]=t,!n)return C;Array.isArray(e)||(e=[e]),Array.isArray(s)||(s=[s]);const r=[],c=()=>{r.forEach(i=>i()),r.length=0},u=(i,d,m,g)=>(i.addEventListener(d,m,g),()=>i.removeEventListener(d,m,g)),f=M(()=>[It(n),v(o)],([i,d])=>{if(c(),!i)return;const m=At(d)?{...d}:d;r.push(...e.flatMap(g=>s.map(x=>u(i,g,x,m))))},{immediate:!0,flush:"post"}),l=()=>{f(),c()};return Lt(l),l}const Q=1;function Vt(t,n={}){const{throttle:e=0,idle:s=200,onStop:o=C,onScroll:r=C,offset:c={left:0,right:0,top:0,bottom:0},eventListenerOptions:u={capture:!1,passive:!0},behavior:f="auto",window:l=Z}=n,i=L(0),d=L(0),m=$({get(){return i.value},set(a){x(a,void 0)}}),g=$({get(){return d.value},set(a){x(void 0,a)}});function x(a,k){var p,D,A;if(!l)return;const y=v(t);y&&((A=y instanceof Document?l.document.body:y)==null||A.scrollTo({top:(p=v(k))!=null?p:g.value,left:(D=v(a))!=null?D:m.value,behavior:v(f)}))}const S=L(!1),h=J({left:!0,right:!1,top:!0,bottom:!1}),b=J({left:!1,right:!1,top:!1,bottom:!1}),W=a=>{S.value&&(S.value=!1,b.left=!1,b.right=!1,b.top=!1,b.bottom=!1,o(a))},q=Ot(W,e+s),O=a=>{var k;if(!l)return;const p=a.document?a.document.documentElement:(k=a.documentElement)!=null?k:a,{display:D,flexDirection:A}=getComputedStyle(p),y=p.scrollLeft;b.left=y<i.value,b.right=y>i.value;const I=Math.abs(y)<=0+(c.left||0),V=Math.abs(y)+p.clientWidth>=p.scrollWidth-(c.right||0)-Q;D==="flex"&&A==="row-reverse"?(h.left=V,h.right=I):(h.left=I,h.right=V),i.value=y;let E=p.scrollTop;a===l.document&&!E&&(E=l.document.body.scrollTop),b.top=E<d.value,b.bottom=E>d.value;const H=Math.abs(E)<=0+(c.top||0),P=Math.abs(E)+p.clientHeight>=p.scrollHeight-(c.bottom||0)-Q;D==="flex"&&A==="column-reverse"?(h.top=P,h.bottom=H):(h.top=H,h.bottom=P),d.value=E},F=a=>{var k;if(!l)return;const p=(k=a.target.documentElement)!=null?k:a.target;O(p),S.value=!0,q(a),r(a)};return K(t,"scroll",e?Wt(F,e,!0,!1):F,u),Ft(()=>{const a=v(t);a&&O(a)}),K(t,"scrollend",W,u),{x:m,y:g,isScrolling:S,arrivedState:h,directions:b,measure(){const a=v(t);l&&a&&O(a)}}}function Nt(t){const n=L(!1),e=L([]),s=L(t==null?void 0:t.termId);let o=1;const r=L(""),c=ot();function u(l){s.value=l}async function f(){if(!(o===-1||n.value))return n.value=!0,c.get("/books",{params:{page:o,s:r.value,termId:s.value}}).then(({data:{data:l}})=>{e.value=e.value.concat(l),l.length?o++:o=-1}).finally(()=>{n.value=!1})}if(f(),(t==null?void 0:t.infinityLoad)===!0){const{arrivedState:l}=Vt(document,{throttle:100,behavior:"smooth",offset:{bottom:100}});M(l,i=>{i.bottom&&f()})}return M(r,et.debounce(()=>{o=1,e.value=[],f()},500)),M(s,()=>{o=1,e.value=[],f()}),{page:o,isLoading:n,books:e,s:r,setTermId:u}}export{Rt as _,Nt as u};
